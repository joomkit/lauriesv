<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- PAGE settings -->
  <meta name="title" content="Laurie Macdonald Counselling and Psychotherapy East Sussex ">
  <meta name="description" content="Online and face to face counselling, psychotherapy &amp; supervision in East sussex. 30yrs experience in NHS &amp; private sector. Book now T:01825 733483">
  <meta name="keywords" content="Counselling, Psychotherapy,Supervision, East Sussex ">
  <meta name="robots" content="index, follow">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="language" content="English">
  <!-- favico -->
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <!-- CSS dependencies -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="https://www.lauriemacdonald.co.uk/wireframe.css">
<style>
  @media print {
    /*#clientsReference{*/
    /*  display:none*/
    /*}*/
  }
</style>
</head>


<body class="">
  <div class="py-4">
    <div class="container mb-3 ">
      <div class="row">
        <div class="col-12 " id="formData">


          <form id="pdfForm"  method="post" accept-charset="UTF-8" >

            <div class="form-group bmd-form-group">
              <label for="name" class="bmd-label-floating">Client name:</label>
              <input type="text" class="form-control" name="name" id="name"  value="" required="" style="cursor: auto;">
            </div>
            <div class="form-group bmd-form-group">
              <label for="clientsReference" class="bmd-label-floating">Client reference:</label>
              <input type="text" class="form-control" name="clientsReference" id="clientsReference" value="" required="">
            </div>
            <div class="form-group bmd-form-group">
              <label for="emailAddress" class="bmd-label-floating">Email address:</label>
              <input type="text" class="form-control" name="emailAddress" id="emailAddress"  value="" required="">
              <span class="bmd-help">I'll never share your email with anyone else.</span>
            </div>
            <button id="agreed" type="submit" class="btn btn-primary">submit</button>
<!--            <a class="btn btn-primary" href="" >I Agree to download and send this to lauriemacdonaldme.com</a>-->
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="bg-dark py-3">
    <div class="container">
      <div class="row d-flex justify-content-between">
        <div class="col-lg-4 col-md-6">
          <p class="text-secondary mb-0">Copyright - 2020</p>
        </div>
        <div class="col-lg-4 col-md-6">
          <p class="text-secondary mb-0"><a href="privacy.html" class="text-secondary">Privacy Policy</a></p>
        </div>
      </div>
    </div>
  </div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <script>

    document.addEventListener('DOMContentLoaded', function (event) {
      var childContainer = document.getElementById('formData');
      var createButton = document.getElementById('agreed');
      var cName = document.getElementById('name');


      cName.addEventListener('input', function (evt) {
        console.log(this.value);
        cName.nodeValue = this.value;
      });


      createButton.addEventListener("click",function(e){
        e.preventDefault();

        var cName = document.getElementById('name').value;
        console.log(cName);


        let p = document.createElement("p");
        childContainer.append(cName,p);
        var myhtml = $('html').html();
        // console.log(myhtml);
        printHtmlToPdf(myhtml);

      });

      function printHtmlToPdf(html) {
        var endpoint = 'https://v2018.api2pdf.com/chrome/html';
        var apikey = '234f8d16-47c7-469a-a9cc-f40d1c445fd9'; //replace this with your own from portal.api2pdf.com
        var payload = {
          "html": html,
          "inlinePdf": true
        };
        $.ajax({
          url: endpoint,
          method: "POST",
          dataType: "json",
          crossDomain: true,
          contentType: "application/json; charset=utf-8",
          data: JSON.stringify(payload),
          cache: false,
          beforeSend: function (xhr) {
            /* Authorization header */
            xhr.setRequestHeader("Authorization", apikey);
          },
          success: function (data) {
            console.log(data.pdf); //this is the url to the pdf, do something with it
          },
          error: function (jqXHR, textStatus, errorThrown) {
            console.log(textStatus);
            console.log(errorThrown);
          }
        });
      }

    });


      $(document).ready(function() {

        function printHtmlToPdf(html) {
          var endpoint = 'https://v2018.api2pdf.com/chrome/html';
          var apikey = '234f8d16-47c7-469a-a9cc-f40d1c445fd9'; //replace this with your own from portal.api2pdf.com
          var payload = {
            "html": html,
            "inlinePdf": true
          };
          $.ajax({
            url: endpoint,
            method: "POST",
            dataType: "json",
            crossDomain: true,
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(payload),
            cache: false,
            beforeSend: function (xhr) {
              /* Authorization header */
              xhr.setRequestHeader("Authorization", apikey);
            },
            success: function (data) {
              console.log(data.pdf); //this is the url to the pdf, do something with it
            },
            error: function (jqXHR, textStatus, errorThrown) {
              console.log(textStatus);
              console.log(errorThrown);
            }
          });
        }

        $( "#agreeLink" ).click(function(event) {
          event.preventDefault();
          var myhtml = $('html').html();
          console.log(myhtml);

          printHtmlToPdf(myhtml)
        });
         //

        // const hash = '?name=some&emailAddress=me@me.com&clientsReference=pool';
        // // const example = "http://example.com/" + hash;
        // var example = window.location.href + '/' + hash;
        // console.log(example);
        // (new URL(example)).searchParams.forEach((x, y) =>
        //         document.getElementById(y).value = x);
        // validate();
        // $('input').on('keyup', validate);
      });


      function validate() {
        var inputsWithValues = 0;

        // get all input fields except for type='submit'
        var myInputs = $("input:not([type='submit'])");

        myInputs.each(function(e) {
          // if it has a value, increment the counter
          var meval = $(this).val();
          console.log(meval);
          if ($(this).val()) {
            inputsWithValues += 1;
            // $(this).prop('value') == meval;
            $(this).val(meval).trigger('change');
          }
        });



        if (inputsWithValues == myInputs.length) {
          $("input[type=submit]").prop("disabled", false);
        } else {
          $("input[type=submit]").prop("disabled", true);
        }
      }
      // const hash = '?name=some_text&email=more%20text';
      // const example = "http://example.com/" + hash;
      //
      // (new URL(example)).searchParams.forEach((x, y) =>
      //     document.getElementById(y).value = x);

      // listen for keys
      //$('input').on('keyup', validate);

      // $('input[name="clientsReference"]').val('clinet reference');
      // $('input[name="name"]').val('name');

      // function validate() {
      //     var inputsWithValues = 0;
      //
      //   // var actionUrl = window.location.href;
      //     // var hash = '';
      //     // var tmpHash = '';
      //     // get all input fields except for type='submit'
      //     var myInputs = $("input:not([type='submit'])");
      //
      //     myInputs.each(function(e) {
      //         // if it has a value, increment the counter
      //         if ($(this).val()) {
      //
      //           console.log($(this).val());
      //           // console.log($(this).attr('id'));
      //           $(this).prop('id') === ('fooo'); // = ("lll");
      //           //   tmpHash =  tmpHash + '&' + $(this).attr('id') + '=' + $(this).val();
      //           // $(this).attr('value') + '=' + $(this).val();
      //           //   console.log($(this).attr('id'));
      //           //   hash = encodeURI(tmpHash);
      //             inputsWithValues += 1;
      //         }
      //     });
      //
      //     console.log(inputsWithValues);
      //
      //     if (inputsWithValues == myInputs.length) {
      //         // set url
      //         // var baseApiPdf = 'https://v2018.api2pdf.com/chrome/url?url';
      //         // var actionUrl = window.location.href + '?' + hash;
      //         // var pdfkey = '234f8d16-47c7-469a-a9cc-f40d1c445fd9';
      //         // var Url = baseApiPdf + '=' + actionUrl + '&apikey=' + pdfkey;
      //         // console.log("url= " + Url);
      //
      //         // $('#agreeLink').attr('href', Url);
      //
      //
      //         $("input[type=submit]").prop("disabled", false);
      //     } else {
      //         $("input[type=submit]").prop("disabled", true);
      //     }
      // }
  </script>
</body>

</html>
